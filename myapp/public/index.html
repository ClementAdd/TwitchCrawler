<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>WEB CRAWLER - HOME</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <link href="app.css" rel="stylesheet" type="text/css">
    <link href="https://cdn.jsdelivr.net/npm/axentix@1.2.1/dist/css/axentix.min.css" rel="stylesheet">
    <script crossorigin="anonymous" src="https://kit.fontawesome.com/76c060ffb5.js"></script>
</head>
<body class="viride light-4">

<header>
    <nav class="navbar shadow-1 viride dark-3">

        <a class="navbar-brand ml-5" href="/" >Web-Crawler</a>
        <a class="navbar-brand fab fa-twitch" href="/" style="margin-top: 2px" ></a>


        <a class="navbar-menu ml-auto fas fa-redo" href="/" style="margin-top: 5px"></a>
        <div class="navbar-menu ml-auto">
            <a class="navbar-link" href="https://git.ytrack.learn.ynov.com/MPHERON/web-crawler"
               target="_blank">Gitea</a>
            <a class="navbar-link" href="/about-us">About Us</a>
        </div>

    </nav>
    </div>
</header>
<main>
    <script>

        let xhr = new XMLHttpRequest();
        xhr.open('GET', 'http://localhost:8080/streamers', true);

        xhr.responseType = 'json';
        xhr.onload = function () {
            if (xhr.readyState === xhr.DONE) {
                if (xhr.status === 200) {
                    let streamers = xhr.response
                    console.log(streamers);
                    let timeGetInfos = document.createElement("div")
                    timeGetInfos.textContent = "Heure de la récupération des données : " + streamers[0];
                    timeGetInfos.style.fontSize = 24 + 'px'
                    document.body.appendChild(timeGetInfos)
                    for (let i = 1; i <= 30; i++) {
                        document.body.appendChild(document.createElement("br"))
                        let divStreamer = document.createElement("div")
                        divStreamer.href = streamers[i].link
                        divStreamer.target = "_blank"
                        divStreamer.setAttribute('id', `stream-${i}`);
                        // divStreamer.className = "card"
                        document.body.appendChild(divStreamer)

                        let nameStreamer = document.createElement("div")
                        nameStreamer.textContent = `n°${i} : ` + streamers[i].nameStreamer
                        document.getElementById(`stream-${i}`).appendChild(nameStreamer)

                        let title = document.createElement("div")
                        title.textContent = streamers[i].title
                        title.setAttribute('id', `title-${i}`);
                        document.getElementById(`stream-${i}`).appendChild(title)

                        let category = document.createElement("div")
                        category.textContent = streamers[i].category
                        document.getElementById(`stream-${i}`).appendChild(category)

                        let viewer = document.createElement("div")
                        viewer.textContent = streamers[i].viewers
                        document.getElementById(`stream-${i}`).appendChild(viewer)

                        let pdp = document.createElement("img")
                        pdp.src = streamers[i].pdp
                        document.getElementById(`stream-${i}`).appendChild(pdp)

                        let miniature = document.createElement("img")
                        miniature.src = streamers[i].miniature
                        document.getElementById(`stream-${i}`).appendChild(miniature)
                    }
                }
            }
        };
        xhr.send(null);
    </script>

    <p> Hello Guys, it's our Web Crawler!</p>


</main>

</body>

</html>
<!--<script src="myapp/main.js" type="module"> getStats()</script>-->
<script src="https://cdn.jsdelivr.net/npm/axentix@1.2.1/dist/js/axentix.min.js"></script>

